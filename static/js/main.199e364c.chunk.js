(this["webpackJsonpsmall-giphy-browser"]=this["webpackJsonpsmall-giphy-browser"]||[]).push([[0],{15:function(e,t,n){e.exports={gifImage:"Gif_gifImage__37hA8"}},17:function(e,t,n){e.exports=n(36)},22:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),a=n(6),c=n.n(a),l=(n(22),n(3)),o=n(1),f="YLcjk5HyeDI0LyWtuNGebAoAKfJYYnju";var u=n(8),s={total:null,gifs:[]},g=Object(u.b)({name:"gifs",initialState:{isFetching:!1,fetchingError:!1,queryString:"",gifsByQueryString:{}},reducers:{appendGifs:function(e,t){var n=e.queryString,i=e.gifsByQueryString[n],r=i?i.gifs:[],a=t.payload,c=a.total,l=a.gifs;e.gifsByQueryString[n]={total:c,gifs:r.concat(l)}},setIsFetching:function(e,t){e.isFetching=t.payload.isFetching},setQueryString:function(e,t){e.queryString=t.payload.queryString},setFetchingError:function(e){e.fetchingError=!0}}}),h=function(e){return e.gifs},m=function(e){var t=h(e),n=t.queryString;return t.gifsByQueryString[n]||s},d=function(e){return m(e).gifs},p=function(e){return h(e).isFetching},y=function(e){var t=m(e),n=t.total,i=t.gifs;return!h(e).fetchingError&&(null===n||i.length<n)},E=function(e){return h(e).queryString},b=function(e){return m(e).total},v=g.actions,_=v.appendGifs,G=v.setIsFetching,S=v.setQueryString,j=v.setFetchingError,O=g.reducer,F=n(4),C=n.n(F);function w(){var e=Object(o.b)(),t=Object(i.useState)(""),n=Object(l.a)(t,2),a=n[0],c=n[1],f=Object(o.c)(p),u=function(){f||e(S({queryString:a}))};return r.a.createElement("div",null,r.a.createElement("input",{type:"text",value:a,onChange:function(e){return c(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&u()},placeholder:"Leave empty to find trending GIFs"}),r.a.createElement("button",{onClick:u,disabled:f},"Search"))}var I=n(16),x=n(15),N=n.n(x);function k(e){var t=e.gif,n=e.blockLoading,a=e.onInView,c=e.onGifLoad,o=e.fullScreen,f=t.title,u=o?t.originalGif:t.fixedHeightGif,s=u.height,g=u.width,h=u.url,m=Object(I.a)({rootMargin:"".concat(500,"px 0px"),threshold:0,triggerOnce:!0}),d=Object(l.a)(m,2),p=d[0],y=d[1];return Object(i.useEffect)((function(){y&&a&&a()}),[y,a]),r.a.createElement("div",{ref:p,className:N.a.gifImage,style:{width:"".concat(g,"px"),height:"".concat(s,"px")}},y&&!n?r.a.createElement("img",{alt:f,height:s,width:g,src:h,onLoad:c,onError:c}):null)}var L=n(5),q=n.n(L);function B(e){var t=e.gif,n=e.onClose;return t&&r.a.createElement("div",{className:q.a.gifFullscreenContainer,onClick:n},r.a.createElement("div",{className:q.a.title},t.title),r.a.createElement("div",{className:q.a.fullscreenGif,onClick:function(e){return e.stopPropagation()}},r.a.createElement(k,{gif:t,fullScreen:!0})),r.a.createElement("div",{className:q.a.fullscreenHint},"Click outside the GIF to exit the fullscreen view"))}function V(e,t,n){e(G({isFetching:!0})),function(e,t,n,i){var r=""!==t,a=new URL(r?"https://api.giphy.com/v1/gifs/search":"https://api.giphy.com/v1/gifs/trending"),c={api_key:f,limit:50,offset:e};r&&(c.q=t),a.search=new URLSearchParams(c).toString(),fetch(a).then((function(e){return e.json()})).then((function(e){var t=e.data.map((function(e){return{id:e.id,title:e.title,fixedHeightGif:e.images.fixed_height,originalGif:e.images.original}}));n({total:e.pagination.total_count,gifs:t})})).catch((function(e){i(e)}))}(t,n,(function(t){var n=t.total,i=t.gifs;e(_({total:n,gifs:i})),e(G({isFetching:!1}))}),(function(t){console.error(t),e(j()),e(G({isFetching:!1}))}))}function H(){var e=Object(o.b)(),t=Object(o.c)(d),n=Object(o.c)(p),a=Object(o.c)(y),c=Object(o.c)(E),f=Object(o.c)(b),u=Object(i.useState)(0),s=Object(l.a)(u,2),g=s[0],h=s[1],m=Object(i.useState)(null),v=Object(l.a)(m,2),_=v[0],G=v[1],S=t.length;Object(i.useEffect)((function(){0===S&&!n&&a&&V(e,S,c)}),[S,n,a,e,c]),Object(i.useEffect)((function(){h(0)}),[c]);var j=function(){h(g+1)},O=""===c?"trending":'"'.concat(c,'"'),F="Showing ".concat(O," GIFs");null!=f&&(F+=": ".concat(S," out of ").concat(f));var I=null;return n?I="Loading...":f===S&&(I="No more results."),r.a.createElement("div",{className:C.a.gifsOuterContainer},r.a.createElement(B,{gif:_,onClose:function(){return G(null)}}),r.a.createElement("h1",null,"Small Giphy Browser"),r.a.createElement(w,null),r.a.createElement("div",{className:C.a.gifsContainer},r.a.createElement("div",{className:C.a.gifsSearch},r.a.createElement("i",null,F)),t.map((function(i,l){return r.a.createElement("div",{key:i.id,className:C.a.gifWrapper,onClick:function(){return G(i)}},r.a.createElement(k,{gif:i,blockLoading:l>=g+5,onInView:l===t.length-1&&!n&&a?V.bind(null,e,S,c):void 0,onGifLoad:j}))})),I&&r.a.createElement("div",{className:C.a.loadingIndicator},r.a.createElement("h2",null,I))))}n(35);var Q=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(H,null))},A=Object(u.a)({reducer:{gifs:O}});c.a.render(r.a.createElement(o.a,{store:A},r.a.createElement(Q,null)),document.getElementById("root"))},4:function(e,t,n){e.exports={gifsOuterContainer:"GifViewer_gifsOuterContainer__rC2Us",gifsContainer:"GifViewer_gifsContainer__3CjEI",gifsSearch:"GifViewer_gifsSearch__RzDAb",loadingIndicator:"GifViewer_loadingIndicator__2gmyb",gifWrapper:"GifViewer_gifWrapper__xIMTR"}},5:function(e,t,n){e.exports={gifFullscreenContainer:"FullscreenGif_gifFullscreenContainer__unBUN",fullscreenHint:"FullscreenGif_fullscreenHint__1LxCG",title:"FullscreenGif_title__1hh_l",fullscreenGif:"FullscreenGif_fullscreenGif__15yBi"}}},[[17,1,2]]]);
//# sourceMappingURL=main.199e364c.chunk.js.map