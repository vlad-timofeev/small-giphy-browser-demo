(this["webpackJsonpsmall-giphy-browser"]=this["webpackJsonpsmall-giphy-browser"]||[]).push([[0],{15:function(e,t,n){e.exports={gifImage:"Gif_gifImage__37hA8"}},17:function(e,t,n){e.exports=n(36)},22:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),a=n(6),c=n.n(a),l=(n(22),n(3)),o=n(1),s=Object({NODE_ENV:"production",PUBLIC_URL:"/small-giphy-browser-demo",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_API_KEY;var f=n(8),u={total:null,gifs:[]},g=Object(f.b)({name:"gifs",initialState:{isFetching:!1,fetchingError:!1,queryString:"",gifsByQueryString:{}},reducers:{appendGifs:function(e,t){var n=e.queryString,i=e.gifsByQueryString[n],r=i?i.gifs:[],a=t.payload,c=a.total,l=a.gifs;e.gifsByQueryString[n]={total:c,gifs:r.concat(l)}},setIsFetching:function(e,t){e.isFetching=t.payload.isFetching},setQueryString:function(e,t){e.queryString=t.payload.queryString},setFetchingError:function(e){e.fetchingError=!0}}}),h=function(e){return e.gifs},d=function(e){var t=h(e),n=t.queryString;return t.gifsByQueryString[n]||u},m=function(e){return d(e).gifs},p=function(e){return h(e).isFetching},_=function(e){var t=d(e),n=t.total,i=t.gifs;return!h(e).fetchingError&&(null===n||i.length<n)},E=function(e){return h(e).queryString},v=function(e){return d(e).total},b=g.actions,y=b.appendGifs,S=b.setIsFetching,O=b.setQueryString,C=b.setFetchingError,G=g.reducer,j=n(4),w=n.n(j);function F(){var e=Object(o.b)(),t=Object(i.useState)(""),n=Object(l.a)(t,2),a=n[0],c=n[1],s=Object(o.c)(p),f=function(){s||e(O({queryString:a}))};return r.a.createElement("div",null,r.a.createElement("input",{type:"text",value:a,onChange:function(e){return c(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&f()},placeholder:"Leave empty to find trending GIFs"}),r.a.createElement("button",{onClick:f,disabled:s},"Search"))}var I=n(16),x=n(15),N=n.n(x);function P(e){var t=e.gif,n=e.blockLoading,a=e.onInView,c=e.onGifLoad,o=e.fullScreen,s=t.title,f=o?t.originalGif:t.fixedHeightGif,u=f.height,g=f.width,h=f.url,d=Object(I.a)({rootMargin:"".concat(500,"px 0px"),threshold:0,triggerOnce:!0}),m=Object(l.a)(d,2),p=m[0],_=m[1];return Object(i.useEffect)((function(){_&&a&&a()}),[_,a]),r.a.createElement("div",{ref:p,className:N.a.gifImage,style:{width:"".concat(g,"px"),height:"".concat(u,"px")}},_&&!n?r.a.createElement("img",{alt:s,height:u,width:g,src:h,onLoad:c,onError:c}):null)}var k=n(5),L=n.n(k);function A(e){var t=e.gif,n=e.onClose;return t&&r.a.createElement("div",{className:L.a.gifFullscreenContainer,onClick:n},r.a.createElement("div",{className:L.a.title},t.title),r.a.createElement("div",{className:L.a.fullscreenGif,onClick:function(e){return e.stopPropagation()}},r.a.createElement(P,{gif:t,fullScreen:!0})),r.a.createElement("div",{className:L.a.fullscreenHint},"Click outside the GIF to exit the fullscreen view"))}function B(e,t,n){e(S({isFetching:!0})),function(e,t,n,i){if(s){var r=""!==t,a=new URL(r?"https://api.giphy.com/v1/gifs/search":"https://api.giphy.com/v1/gifs/trending"),c={api_key:s,limit:50,offset:e};r&&(c.q=t),a.search=new URLSearchParams(c).toString(),fetch(a).then((function(e){return e.json()})).then((function(e){var t=e.data.map((function(e){return{id:e.id,title:e.title,fixedHeightGif:e.images.fixed_height,originalGif:e.images.original}}));n({total:e.pagination.total_count,gifs:t})})).catch((function(e){i(e)}))}else i("Please set API key with REACT_APP_API_KEY env. var.")}(t,n,(function(t){var n=t.total,i=t.gifs;e(y({total:n,gifs:i})),e(S({isFetching:!1}))}),(function(t){console.error(t),e(C()),e(S({isFetching:!1}))}))}function T(){var e=Object(o.b)(),t=Object(o.c)(m),n=Object(o.c)(p),a=Object(o.c)(_),c=Object(o.c)(E),s=Object(o.c)(v),f=Object(i.useState)(0),u=Object(l.a)(f,2),g=u[0],h=u[1],d=Object(i.useState)(null),b=Object(l.a)(d,2),y=b[0],S=b[1],O=t.length;Object(i.useEffect)((function(){0===O&&!n&&a&&B(e,O,c)}),[O,n,a,e,c]),Object(i.useEffect)((function(){h(0)}),[c]);var C=function(){h(g+1)},G=""===c?"trending":'"'.concat(c,'"'),j="Showing ".concat(G," GIFs");null!=s&&(j+=": ".concat(O," out of ").concat(s));var I=null;return n?I="Loading...":s===O&&(I="No more results."),r.a.createElement("div",{className:w.a.gifsOuterContainer},r.a.createElement(A,{gif:y,onClose:function(){return S(null)}}),r.a.createElement("h1",null,"Small Giphy Browser"),r.a.createElement(F,null),r.a.createElement("div",{className:w.a.gifsContainer},r.a.createElement("div",{className:w.a.gifsSearch},r.a.createElement("i",null,j)),t.map((function(i,l){return r.a.createElement("div",{key:i.id,className:w.a.gifWrapper,onClick:function(){return S(i)}},r.a.createElement(P,{gif:i,blockLoading:l>=g+5,onInView:l===t.length-1&&!n&&a?B.bind(null,e,O,c):void 0,onGifLoad:C}))})),I&&r.a.createElement("div",{className:w.a.loadingIndicator},r.a.createElement("h2",null,I))))}n(35);var q=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(T,null))},R=Object(f.a)({reducer:{gifs:G}});c.a.render(r.a.createElement(o.a,{store:R},r.a.createElement(q,null)),document.getElementById("root"))},4:function(e,t,n){e.exports={gifsOuterContainer:"GifViewer_gifsOuterContainer__rC2Us",gifsContainer:"GifViewer_gifsContainer__3CjEI",gifsSearch:"GifViewer_gifsSearch__RzDAb",loadingIndicator:"GifViewer_loadingIndicator__2gmyb",gifWrapper:"GifViewer_gifWrapper__xIMTR"}},5:function(e,t,n){e.exports={gifFullscreenContainer:"FullscreenGif_gifFullscreenContainer__unBUN",fullscreenHint:"FullscreenGif_fullscreenHint__1LxCG",title:"FullscreenGif_title__1hh_l",fullscreenGif:"FullscreenGif_fullscreenGif__15yBi"}}},[[17,1,2]]]);
//# sourceMappingURL=main.969dbb58.chunk.js.map